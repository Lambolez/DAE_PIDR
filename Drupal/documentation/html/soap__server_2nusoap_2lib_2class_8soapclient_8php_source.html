<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DAEDrupalInterface: modules/soap_server/nusoap/lib/class.soapclient.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>modules/soap_server/nusoap/lib/class.soapclient.php</h1><a href="soap__server_2nusoap_2lib_2class_8soapclient_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 
<a name="l00026"></a>00026 <span class="keyword">class </span><a class="code" href="classnusoap__client.html">nusoap_client</a> <span class="keyword">extends</span> <a class="code" href="classnusoap__base.html">nusoap_base</a>  {
<a name="l00027"></a>00027 
<a name="l00028"></a>00028         var <a class="code" href="classnusoap__client.html#a5a6e502b71a3d980d0d5b4f78a3836b2">$username</a> = <span class="stringliteral">&#39;&#39;</span>;                             <span class="comment">// Username for HTTP authentication</span>
<a name="l00029"></a>00029         var <a class="code" href="classnusoap__client.html#a28db01da63367bdca6f6be2518c12548">$password</a> = <span class="stringliteral">&#39;&#39;</span>;                             <span class="comment">// Password for HTTP authentication</span>
<a name="l00030"></a>00030         var <a class="code" href="classnusoap__client.html#a53330860c9fb44f860900eea3db67770">$authtype</a> = <span class="stringliteral">&#39;&#39;</span>;                             <span class="comment">// Type of HTTP authentication</span>
<a name="l00031"></a>00031         var <a class="code" href="classnusoap__client.html#af9f9e6aca1a464fae03b4bcfe6be85d1">$certRequest</a> = array();             <span class="comment">// Certificate for HTTP SSL authentication</span>
<a name="l00032"></a>00032         var <a class="code" href="classnusoap__client.html#ad320cab74dd4ce0f0464c4d956b5aa57">$requestHeaders</a> = <span class="keyword">false</span>;    <span class="comment">// SOAP headers in request (text)</span>
<a name="l00033"></a>00033         var <a class="code" href="classnusoap__client.html#a7fee8ad0f5d6ce94517476ec88633a96">$responseHeaders</a> = <span class="stringliteral">&#39;&#39;</span>;              <span class="comment">// SOAP headers from response (incomplete namespace resolution) (text)</span>
<a name="l00034"></a>00034         var <a class="code" href="classnusoap__client.html#ae1fff303aa9712aed09e1c7c47a1acb3">$responseHeader</a> = NULL;             <span class="comment">// SOAP Header from response (parsed)</span>
<a name="l00035"></a>00035         var <a class="code" href="classnusoap__client.html#a3573f7decf2dad4d382c8eadede55feb">$document</a> = <span class="stringliteral">&#39;&#39;</span>;                             <span class="comment">// SOAP body response portion (incomplete namespace resolution) (text)</span>
<a name="l00036"></a>00036         var <a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>;
<a name="l00037"></a>00037         var <a class="code" href="classnusoap__client.html#a162a547fc8450f869106630e5c36d4b0">$forceEndpoint</a> = <span class="stringliteral">&#39;&#39;</span>;                <span class="comment">// overrides WSDL endpoint</span>
<a name="l00038"></a>00038     var <a class="code" href="classnusoap__client.html#aa338793644c3c11e9f26b037183edcb4">$proxyhost</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00039"></a>00039     var <a class="code" href="classnusoap__client.html#a0ec7742ef4e60957bb2434e4ae1687b9">$proxyport</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00040"></a>00040         var <a class="code" href="classnusoap__client.html#a7cd6d5a82fb6497a40aab27e1912cfea">$proxyusername</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00041"></a>00041         var <a class="code" href="classnusoap__client.html#abba1ff96c63993ea3e2cc3ce50679d30">$proxypassword</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00042"></a>00042         var <a class="code" href="classnusoap__client.html#a7ec0d9a68da32080cead7a60731d8e4c">$portName</a> = <span class="stringliteral">&#39;&#39;</span>;                             <span class="comment">// port name to use in WSDL</span>
<a name="l00043"></a>00043     var <a class="code" href="classnusoap__client.html#acf04b75f2d49f60a1ac82874716f9679">$xml_encoding</a> = <span class="stringliteral">&#39;&#39;</span>;                     <span class="comment">// character set encoding of incoming (response) messages</span>
<a name="l00044"></a>00044         var <a class="code" href="classnusoap__client.html#a54703a12701fae9afb140eabe3d1e4db">$http_encoding</a> = <span class="keyword">false</span>;
<a name="l00045"></a>00045         var <a class="code" href="classnusoap__client.html#aba5ca2d7e6c45a4773cddec256c9a192">$timeout</a> = 0;                               <span class="comment">// HTTP connection timeout</span>
<a name="l00046"></a>00046         var <a class="code" href="classnusoap__client.html#a41b0366193fea3a46ac06dd3d794429f">$response_timeout</a> = 30;             <span class="comment">// HTTP response timeout</span>
<a name="l00047"></a>00047         var <a class="code" href="classnusoap__client.html#ae3547ad69cc1ff7bde5c5ef5de87227a">$endpointType</a> = <span class="stringliteral">&#39;&#39;</span>;                 <span class="comment">// soap|wsdl, empty for WSDL initialization error</span>
<a name="l00048"></a>00048         var <a class="code" href="classnusoap__client.html#aa593f779ab668b831a03cf94ceba32ab">$persistentConnection</a> = <span class="keyword">false</span>;
<a name="l00049"></a>00049         var <a class="code" href="classnusoap__client.html#a1e0f4fe64cbcf6b2a3d006c369f92d94">$defaultRpcParams</a> = <span class="keyword">false</span>;  <span class="comment">// This is no longer used</span>
<a name="l00050"></a>00050         var <a class="code" href="classnusoap__client.html#ab417cda4f1b025788de6687b390826fe">$request</a> = <span class="stringliteral">&#39;&#39;</span>;                              <span class="comment">// HTTP request</span>
<a name="l00051"></a>00051         var <a class="code" href="classnusoap__client.html#a7e876745b5c4171d6dc444567a01eefe">$response</a> = <span class="stringliteral">&#39;&#39;</span>;                             <span class="comment">// HTTP response</span>
<a name="l00052"></a>00052         var <a class="code" href="classnusoap__client.html#a299b06904e689a23a5d75aed67889b4b">$responseData</a> = <span class="stringliteral">&#39;&#39;</span>;                 <span class="comment">// SOAP payload of response</span>
<a name="l00053"></a>00053         var <a class="code" href="classnusoap__client.html#a488524f98da3cb0b016d393d39f48720">$cookies</a> = array();                 <span class="comment">// Cookies from response or for request</span>
<a name="l00054"></a>00054     var <a class="code" href="classnusoap__client.html#a42f9ed3ac5f161b03390790ec5240738">$decode_utf8</a> = <span class="keyword">true</span>;            <span class="comment">// toggles whether the parser decodes element content w/ utf8_decode()</span>
<a name="l00055"></a>00055         var <a class="code" href="classnusoap__client.html#a40f85bac1d2155f301c0c2c5edc4193e">$operations</a> = array();              <span class="comment">// WSDL operations, empty for WSDL initialization error</span>
<a name="l00056"></a>00056         var <a class="code" href="classnusoap__client.html#a148143e9835ef9704d78f65b6170d731">$curl_options</a> = array();    <span class="comment">// User-specified cURL options</span>
<a name="l00057"></a>00057         var <a class="code" href="classnusoap__client.html#a3feacea870c1a4b8cba123e958d7f932">$bindingType</a> = <span class="stringliteral">&#39;&#39;</span>;                  <span class="comment">// WSDL operation binding type</span>
<a name="l00058"></a>00058         var <a class="code" href="classnusoap__client.html#a30f8422d6d223166575d68dd4674d65b">$use_curl</a> = <span class="keyword">false</span>;                  <span class="comment">// whether to always try to use cURL</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="comment">/*</span>
<a name="l00061"></a>00061 <span class="comment">         * fault related variables</span>
<a name="l00062"></a>00062 <span class="comment">         */</span>
<a name="l00067"></a>00067         var <a class="code" href="classnusoap__client.html#adf3ebb9ddbb9430ccecb42b1d8956bbd">$fault</a>;
<a name="l00072"></a>00072         var <a class="code" href="classnusoap__client.html#a78c615b04a77b7b01d4c37ccf25d4693">$faultcode</a>;
<a name="l00077"></a>00077         var <a class="code" href="classnusoap__client.html#a162a031f2ef0cbe0eb6006016f25b389">$faultstring</a>;
<a name="l00082"></a>00082         var <a class="code" href="classnusoap__client.html#a4503a687b0a0ec31d3be9f73d58a9ca7">$faultdetail</a>;
<a name="l00083"></a>00083 
<a name="l00098"></a><a class="code" href="classnusoap__client.html#aa9b69fa44881ef612b83e263c0918179">00098</a>         function <a class="code" href="classnusoap__client.html#aa9b69fa44881ef612b83e263c0918179">nusoap_client</a>(<a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>,<a class="code" href="soap__server__test_8php.html#a8b3fb8293ad64e3dc0b814fedf24c5dd">$wsdl</a> = <span class="keyword">false</span>,<a class="code" href="classnusoap__client.html#aa338793644c3c11e9f26b037183edcb4">$proxyhost</a> = <span class="keyword">false</span>,<a class="code" href="classnusoap__client.html#a0ec7742ef4e60957bb2434e4ae1687b9">$proxyport</a> = <span class="keyword">false</span>,<a class="code" href="classnusoap__client.html#a7cd6d5a82fb6497a40aab27e1912cfea">$proxyusername</a> = <span class="keyword">false</span>, <a class="code" href="classnusoap__client.html#abba1ff96c63993ea3e2cc3ce50679d30">$proxypassword</a> = <span class="keyword">false</span>, <a class="code" href="classnusoap__client.html#aba5ca2d7e6c45a4773cddec256c9a192">$timeout</a> = 0, <a class="code" href="classnusoap__client.html#a41b0366193fea3a46ac06dd3d794429f">$response_timeout</a> = 30, <a class="code" href="classnusoap__client.html#a7ec0d9a68da32080cead7a60731d8e4c">$portName</a> = <span class="stringliteral">&#39;&#39;</span>){
<a name="l00099"></a>00099                 <a class="code" href="classnusoap__base.html#a236c7ba11817473af2af447e11fba3b0">parent::nusoap_base</a>();
<a name="l00100"></a>00100                 $this-&gt;endpoint = <a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>;
<a name="l00101"></a>00101                 $this-&gt;proxyhost = <a class="code" href="classnusoap__client.html#aa338793644c3c11e9f26b037183edcb4">$proxyhost</a>;
<a name="l00102"></a>00102                 $this-&gt;proxyport = <a class="code" href="classnusoap__client.html#a0ec7742ef4e60957bb2434e4ae1687b9">$proxyport</a>;
<a name="l00103"></a>00103                 $this-&gt;proxyusername = <a class="code" href="classnusoap__client.html#a7cd6d5a82fb6497a40aab27e1912cfea">$proxyusername</a>;
<a name="l00104"></a>00104                 $this-&gt;proxypassword = <a class="code" href="classnusoap__client.html#abba1ff96c63993ea3e2cc3ce50679d30">$proxypassword</a>;
<a name="l00105"></a>00105                 $this-&gt;timeout = <a class="code" href="classnusoap__client.html#aba5ca2d7e6c45a4773cddec256c9a192">$timeout</a>;
<a name="l00106"></a>00106                 $this-&gt;response_timeout = <a class="code" href="classnusoap__client.html#a41b0366193fea3a46ac06dd3d794429f">$response_timeout</a>;
<a name="l00107"></a>00107                 $this-&gt;portName = <a class="code" href="classnusoap__client.html#a7ec0d9a68da32080cead7a60731d8e4c">$portName</a>;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;ctor wsdl=$wsdl timeout=$timeout response_timeout=$response_timeout&quot;</span>);
<a name="l00110"></a>00110                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>(<span class="stringliteral">&#39;endpoint=&#39;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>(<a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>));
<a name="l00111"></a>00111 
<a name="l00112"></a>00112                 <span class="comment">// make values</span>
<a name="l00113"></a>00113                 <span class="keywordflow">if</span>(<a class="code" href="soap__server__test_8php.html#a8b3fb8293ad64e3dc0b814fedf24c5dd">$wsdl</a>){
<a name="l00114"></a>00114                         <span class="keywordflow">if</span> (is_object(<a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>) &amp;&amp; (get_class(<a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>) == <span class="stringliteral">&#39;wsdl&#39;</span>)) {
<a name="l00115"></a>00115                                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a> = <a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>;
<a name="l00116"></a>00116                                 $this-&gt;endpoint = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;wsdl;
<a name="l00117"></a>00117                                 $this-&gt;wsdlFile = $this-&gt;endpoint;
<a name="l00118"></a>00118                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;existing wsdl instance created from &#39;</span> . $this-&gt;endpoint);
<a name="l00119"></a>00119                                 $this-&gt;<a class="code" href="classnusoap__client.html#a9df6a7844a1a356eba2d3486c7afb429">checkWSDL</a>();
<a name="l00120"></a>00120                         } <span class="keywordflow">else</span> {
<a name="l00121"></a>00121                                 $this-&gt;wsdlFile = $this-&gt;endpoint;
<a name="l00122"></a>00122                                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a> = null;
<a name="l00123"></a>00123                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;will use lazy evaluation of wsdl from &#39;</span> . $this-&gt;endpoint);
<a name="l00124"></a>00124                         }
<a name="l00125"></a>00125                         $this-&gt;endpointType = <span class="stringliteral">&#39;wsdl&#39;</span>;
<a name="l00126"></a>00126                 } <span class="keywordflow">else</span> {
<a name="l00127"></a>00127                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;instantiate SOAP with endpoint at $endpoint&quot;</span>);
<a name="l00128"></a>00128                         $this-&gt;endpointType = <span class="stringliteral">&#39;soap&#39;</span>;
<a name="l00129"></a>00129                 }
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131 
<a name="l00157"></a><a class="code" href="classnusoap__client.html#a4518fdf7c9d1939722e8cf1cd67a5028">00157</a>         function <a class="code" href="classnusoap__client.html#a4518fdf7c9d1939722e8cf1cd67a5028">call</a>($operation,$params=array(),$namespace=<span class="stringliteral">&#39;http://tempuri.org&#39;</span>,$soapAction=<span class="stringliteral">&#39;&#39;</span>,$headers=<span class="keyword">false</span>,$rpcParams=null,$style=<span class="stringliteral">&#39;rpc&#39;</span>,$use=<span class="stringliteral">&#39;encoded&#39;</span>){
<a name="l00158"></a>00158                 $this-&gt;operation = $operation;
<a name="l00159"></a>00159                 $this-&gt;fault = <span class="keyword">false</span>;
<a name="l00160"></a>00160                 $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;&#39;</span>);
<a name="l00161"></a>00161                 $this-&gt;request = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00162"></a>00162                 $this-&gt;response = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00163"></a>00163                 $this-&gt;responseData = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00164"></a>00164                 $this-&gt;faultstring = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00165"></a>00165                 $this-&gt;faultcode = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00166"></a>00166                 $this-&gt;opData = array();
<a name="l00167"></a>00167                 
<a name="l00168"></a>00168                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;call: operation=$operation, namespace=$namespace, soapAction=$soapAction, rpcParams=$rpcParams, style=$style, use=$use, endpointType=$this-&gt;endpointType&quot;</span>);
<a name="l00169"></a>00169                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>(<span class="stringliteral">&#39;params=&#39;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($params));
<a name="l00170"></a>00170                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>(<span class="stringliteral">&#39;headers=&#39;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($headers));
<a name="l00171"></a>00171                 <span class="keywordflow">if</span> ($headers) {
<a name="l00172"></a>00172                         $this-&gt;requestHeaders = $headers;
<a name="l00173"></a>00173                 }
<a name="l00174"></a>00174                 <span class="keywordflow">if</span> ($this-&gt;endpointType == <span class="stringliteral">&#39;wsdl&#39;</span> &amp;&amp; is_null($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>)) {
<a name="l00175"></a>00175                         $this-&gt;<a class="code" href="classnusoap__client.html#aa71b9cdc567fc894b85891235f0028c5">loadWSDL</a>();
<a name="l00176"></a>00176                         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>())
<a name="l00177"></a>00177                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00178"></a>00178                 }
<a name="l00179"></a>00179                 <span class="comment">// serialize parameters</span>
<a name="l00180"></a>00180                 <span class="keywordflow">if</span>($this-&gt;endpointType == <span class="stringliteral">&#39;wsdl&#39;</span> &amp;&amp; $opData = $this-&gt;<a class="code" href="classnusoap__client.html#a8596422939874a9ed4bc5d1715807869">getOperationData</a>($operation)){
<a name="l00181"></a>00181                         <span class="comment">// use WSDL for operation</span>
<a name="l00182"></a>00182                         $this-&gt;opData = $opData;
<a name="l00183"></a>00183                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;found operation&quot;</span>);
<a name="l00184"></a>00184                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>(<span class="stringliteral">&#39;opData=&#39;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($opData));
<a name="l00185"></a>00185                         <span class="keywordflow">if</span> (isset($opData[<span class="stringliteral">&#39;soapAction&#39;</span>])) {
<a name="l00186"></a>00186                                 $soapAction = $opData[<span class="stringliteral">&#39;soapAction&#39;</span>];
<a name="l00187"></a>00187                         }
<a name="l00188"></a>00188                         <span class="keywordflow">if</span> (! $this-&gt;forceEndpoint) {
<a name="l00189"></a>00189                                 $this-&gt;endpoint = $opData[<span class="stringliteral">&#39;endpoint&#39;</span>];
<a name="l00190"></a>00190                         } <span class="keywordflow">else</span> {
<a name="l00191"></a>00191                                 $this-&gt;endpoint = $this-&gt;forceEndpoint;
<a name="l00192"></a>00192                         }
<a name="l00193"></a>00193                         $namespace = isset($opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;namespace&#39;</span>]) ? $opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;namespace&#39;</span>] :     $namespace;
<a name="l00194"></a>00194                         $style = $opData[<span class="stringliteral">&#39;style&#39;</span>];
<a name="l00195"></a>00195                         $use = $opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;use&#39;</span>];
<a name="l00196"></a>00196                         <span class="comment">// add ns to ns array</span>
<a name="l00197"></a>00197                         <span class="keywordflow">if</span>($namespace != <span class="stringliteral">&#39;&#39;</span> &amp;&amp; !isset($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;namespaces[$namespace])){
<a name="l00198"></a>00198                                 $nsPrefix = <span class="stringliteral">&#39;ns&#39;</span> . rand(1000, 9999);
<a name="l00199"></a>00199                                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;namespaces[$nsPrefix] = $namespace;
<a name="l00200"></a>00200                         }
<a name="l00201"></a>00201             $nsPrefix = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getPrefixFromNamespace($namespace);
<a name="l00202"></a>00202                         <span class="comment">// serialize payload</span>
<a name="l00203"></a>00203                         <span class="keywordflow">if</span> (is_string($params)) {
<a name="l00204"></a>00204                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;serializing param string for WSDL operation $operation&quot;</span>);
<a name="l00205"></a>00205                                 $payload = $params;
<a name="l00206"></a>00206                         } elseif (is_array($params)) {
<a name="l00207"></a>00207                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;serializing param array for WSDL operation $operation&quot;</span>);
<a name="l00208"></a>00208                                 $payload = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;serializeRPCParameters($operation,<span class="stringliteral">&#39;input&#39;</span>,$params,$this-&gt;bindingType);
<a name="l00209"></a>00209                         } <span class="keywordflow">else</span> {
<a name="l00210"></a>00210                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;params must be array or string&#39;</span>);
<a name="l00211"></a>00211                                 $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;params must be array or string&#39;</span>);
<a name="l00212"></a>00212                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00213"></a>00213                         }
<a name="l00214"></a>00214             <a class="code" href="classnusoap__base.html#aa00bbae327f1af845ce260e23e43fdb6">$usedNamespaces</a> = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;usedNamespaces;
<a name="l00215"></a>00215                         <span class="keywordflow">if</span> (isset($opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;encodingStyle&#39;</span>])) {
<a name="l00216"></a>00216                                 $encodingStyle = $opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;encodingStyle&#39;</span>];
<a name="l00217"></a>00217                         } <span class="keywordflow">else</span> {
<a name="l00218"></a>00218                                 $encodingStyle = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00219"></a>00219                         }
<a name="l00220"></a>00220                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00221"></a>00221                         $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00222"></a>00222                         <span class="keywordflow">if</span> ($errstr = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getError()) {
<a name="l00223"></a>00223                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;got wsdl error: &#39;</span>.$errstr);
<a name="l00224"></a>00224                                 $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;wsdl error: &#39;</span>.$errstr);
<a name="l00225"></a>00225                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00226"></a>00226                         }
<a name="l00227"></a>00227                 } elseif($this-&gt;endpointType == <span class="stringliteral">&#39;wsdl&#39;</span>) {
<a name="l00228"></a>00228                         <span class="comment">// operation not in WSDL</span>
<a name="l00229"></a>00229                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00230"></a>00230                         $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00231"></a>00231                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;operation &#39;</span>.$operation.<span class="stringliteral">&#39; not present in WSDL.&#39;</span>);
<a name="l00232"></a>00232                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;operation &#39;$operation&#39; not present in WSDL.&quot;</span>);
<a name="l00233"></a>00233                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00234"></a>00234                 } <span class="keywordflow">else</span> {
<a name="l00235"></a>00235                         <span class="comment">// no WSDL</span>
<a name="l00236"></a>00236                         <span class="comment">//$this-&gt;namespaces[&#39;ns1&#39;] = $namespace;</span>
<a name="l00237"></a>00237                         $nsPrefix = <span class="stringliteral">&#39;ns&#39;</span> . rand(1000, 9999);
<a name="l00238"></a>00238                         <span class="comment">// serialize </span>
<a name="l00239"></a>00239                         $payload = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00240"></a>00240                         <span class="keywordflow">if</span> (is_string($params)) {
<a name="l00241"></a>00241                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;serializing param string for operation $operation&quot;</span>);
<a name="l00242"></a>00242                                 $payload = $params;
<a name="l00243"></a>00243                         } elseif (is_array($params)) {
<a name="l00244"></a>00244                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;serializing param array for operation $operation&quot;</span>);
<a name="l00245"></a>00245                                 <span class="keywordflow">foreach</span>($params as $k =&gt; $v){
<a name="l00246"></a>00246                                         $payload .= $this-&gt;<a class="code" href="classnusoap__base.html#a60ee09e022c9270ea717783c32083d74">serialize_val</a>($v,$k,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,$use);
<a name="l00247"></a>00247                                 }
<a name="l00248"></a>00248                         } <span class="keywordflow">else</span> {
<a name="l00249"></a>00249                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;params must be array or string&#39;</span>);
<a name="l00250"></a>00250                                 $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;params must be array or string&#39;</span>);
<a name="l00251"></a>00251                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00252"></a>00252                         }
<a name="l00253"></a>00253                         <a class="code" href="classnusoap__base.html#aa00bbae327f1af845ce260e23e43fdb6">$usedNamespaces</a> = array();
<a name="l00254"></a>00254                         <span class="keywordflow">if</span> ($use == <span class="stringliteral">&#39;encoded&#39;</span>) {
<a name="l00255"></a>00255                                 $encodingStyle = <span class="stringliteral">&#39;http://schemas.xmlsoap.org/soap/encoding/&#39;</span>;
<a name="l00256"></a>00256                         } <span class="keywordflow">else</span> {
<a name="l00257"></a>00257                                 $encodingStyle = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00258"></a>00258                         }
<a name="l00259"></a>00259                 }
<a name="l00260"></a>00260                 <span class="comment">// wrap RPC calls with method element</span>
<a name="l00261"></a>00261                 <span class="keywordflow">if</span> ($style == <span class="stringliteral">&#39;rpc&#39;</span>) {
<a name="l00262"></a>00262                         <span class="keywordflow">if</span> ($use == <span class="stringliteral">&#39;literal&#39;</span>) {
<a name="l00263"></a>00263                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;wrapping RPC request with literal method element&quot;</span>);
<a name="l00264"></a>00264                                 <span class="keywordflow">if</span> ($namespace) {
<a name="l00265"></a>00265                                         <span class="comment">// http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html R2735 says rpc/literal accessor elements should not be in a namespace</span>
<a name="l00266"></a>00266                                         $payload = <span class="stringliteral">&quot;&lt;$nsPrefix:$operation xmlns:$nsPrefix=\&quot;$namespace\&quot;&gt;&quot;</span> .
<a name="l00267"></a>00267                                                                 $payload .
<a name="l00268"></a>00268                                                                 <span class="stringliteral">&quot;&lt;/$nsPrefix:$operation&gt;&quot;</span>;
<a name="l00269"></a>00269                                 } <span class="keywordflow">else</span> {
<a name="l00270"></a>00270                                         $payload = <span class="stringliteral">&quot;&lt;$operation&gt;&quot;</span> . $payload . <span class="stringliteral">&quot;&lt;/$operation&gt;&quot;</span>;
<a name="l00271"></a>00271                                 }
<a name="l00272"></a>00272                         } <span class="keywordflow">else</span> {
<a name="l00273"></a>00273                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;wrapping RPC request with encoded method element&quot;</span>);
<a name="l00274"></a>00274                                 <span class="keywordflow">if</span> ($namespace) {
<a name="l00275"></a>00275                                         $payload = <span class="stringliteral">&quot;&lt;$nsPrefix:$operation xmlns:$nsPrefix=\&quot;$namespace\&quot;&gt;&quot;</span> .
<a name="l00276"></a>00276                                                                 $payload .
<a name="l00277"></a>00277                                                                 <span class="stringliteral">&quot;&lt;/$nsPrefix:$operation&gt;&quot;</span>;
<a name="l00278"></a>00278                                 } <span class="keywordflow">else</span> {
<a name="l00279"></a>00279                                         $payload = <span class="stringliteral">&quot;&lt;$operation&gt;&quot;</span> .
<a name="l00280"></a>00280                                                                 $payload .
<a name="l00281"></a>00281                                                                 <span class="stringliteral">&quot;&lt;/$operation&gt;&quot;</span>;
<a name="l00282"></a>00282                                 }
<a name="l00283"></a>00283                         }
<a name="l00284"></a>00284                 }
<a name="l00285"></a>00285                 <span class="comment">// serialize envelope</span>
<a name="l00286"></a>00286                 $soapmsg = $this-&gt;<a class="code" href="classnusoap__base.html#a8940fff9aa5bc728be4fee5c5d319d5e">serializeEnvelope</a>($payload,$this-&gt;requestHeaders,<a class="code" href="classnusoap__base.html#aa00bbae327f1af845ce260e23e43fdb6">$usedNamespaces</a>,$style,$use,$encodingStyle);
<a name="l00287"></a>00287                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;endpoint=$this-&gt;endpoint, soapAction=$soapAction, namespace=$namespace, style=$style, use=$use, encodingStyle=$encodingStyle&quot;</span>);
<a name="l00288"></a>00288                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;SOAP message length=&#39;</span> . strlen($soapmsg) . <span class="stringliteral">&#39; contents (max 1000 bytes)=&#39;</span> . substr($soapmsg, 0, 1000));
<a name="l00289"></a>00289                 <span class="comment">// send</span>
<a name="l00290"></a>00290                 $return = $this-&gt;<a class="code" href="classnusoap__client.html#a1a9ee5485589e291619da192324f70bc">send</a>($this-&gt;<a class="code" href="classnusoap__client.html#aa7d92aba4e7fd910b55f68b43e72eda9">getHTTPBody</a>($soapmsg),$soapAction,$this-&gt;timeout,$this-&gt;response_timeout);
<a name="l00291"></a>00291                 <span class="keywordflow">if</span>($errstr = $this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>()){
<a name="l00292"></a>00292                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Error: &#39;</span>.$errstr);
<a name="l00293"></a>00293                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00294"></a>00294                 } <span class="keywordflow">else</span> {
<a name="l00295"></a>00295                         $this-&gt;<span class="keywordflow">return</span> = $return;
<a name="l00296"></a>00296                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;sent message successfully and got a(n) &#39;</span>.gettype($return));
<a name="l00297"></a>00297                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>(<span class="stringliteral">&#39;return=&#39;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($return));
<a name="l00298"></a>00298                         
<a name="l00299"></a>00299                         <span class="comment">// fault?</span>
<a name="l00300"></a>00300                         <span class="keywordflow">if</span>(is_array($return) &amp;&amp; isset($return[<span class="stringliteral">&#39;faultcode&#39;</span>])){
<a name="l00301"></a>00301                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;got fault&#39;</span>);
<a name="l00302"></a>00302                                 $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>($return[<span class="stringliteral">&#39;faultcode&#39;</span>].<span class="stringliteral">&#39;: &#39;</span>.$return[<span class="stringliteral">&#39;faultstring&#39;</span>]);
<a name="l00303"></a>00303                                 $this-&gt;fault = <span class="keyword">true</span>;
<a name="l00304"></a>00304                                 <span class="keywordflow">foreach</span>($return as $k =&gt; $v){
<a name="l00305"></a>00305                                         $this-&gt;$k = $v;
<a name="l00306"></a>00306                                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;$k = $v&lt;br&gt;&quot;</span>);
<a name="l00307"></a>00307                                 }
<a name="l00308"></a>00308                                 <span class="keywordflow">return</span> $return;
<a name="l00309"></a>00309                         } elseif ($style == <span class="stringliteral">&#39;document&#39;</span>) {
<a name="l00310"></a>00310                                 <span class="comment">// NOTE: if the response is defined to have multiple parts (i.e. unwrapped),</span>
<a name="l00311"></a>00311                                 <span class="comment">// we are only going to return the first part here...sorry about that</span>
<a name="l00312"></a>00312                                 <span class="keywordflow">return</span> $return;
<a name="l00313"></a>00313                         } <span class="keywordflow">else</span> {
<a name="l00314"></a>00314                                 <span class="comment">// array of return values</span>
<a name="l00315"></a>00315                                 <span class="keywordflow">if</span>(is_array($return)){
<a name="l00316"></a>00316                                         <span class="comment">// multiple &#39;out&#39; parameters, which we return wrapped up</span>
<a name="l00317"></a>00317                                         <span class="comment">// in the array</span>
<a name="l00318"></a>00318                                         <span class="keywordflow">if</span>(<span class="keyword">sizeof</span>($return) &gt; 1){
<a name="l00319"></a>00319                                                 <span class="keywordflow">return</span> $return;
<a name="l00320"></a>00320                                         }
<a name="l00321"></a>00321                                         <span class="comment">// single &#39;out&#39; parameter (normally the return value)</span>
<a name="l00322"></a>00322                                         $return = array_shift($return);
<a name="l00323"></a>00323                                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;return shifted value: &#39;</span>);
<a name="l00324"></a>00324                                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($return));
<a name="l00325"></a>00325                                 <span class="keywordflow">return</span> $return;
<a name="l00326"></a>00326                                 <span class="comment">// nothing returned (ie, echoVoid)</span>
<a name="l00327"></a>00327                                 } <span class="keywordflow">else</span> {
<a name="l00328"></a>00328                                         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00329"></a>00329                                 }
<a name="l00330"></a>00330                         }
<a name="l00331"></a>00331                 }
<a name="l00332"></a>00332         }
<a name="l00333"></a>00333 
<a name="l00339"></a><a class="code" href="classnusoap__client.html#a9df6a7844a1a356eba2d3486c7afb429">00339</a>         function <a class="code" href="classnusoap__client.html#a9df6a7844a1a356eba2d3486c7afb429">checkWSDL</a>() {
<a name="l00340"></a>00340                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00341"></a>00341                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00342"></a>00342                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;checkWSDL&#39;</span>);
<a name="l00343"></a>00343                 <span class="comment">// catch errors</span>
<a name="l00344"></a>00344                 <span class="keywordflow">if</span> ($errstr = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getError()) {
<a name="l00345"></a>00345                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00346"></a>00346                         $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00347"></a>00347                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;got wsdl error: &#39;</span>.$errstr);
<a name="l00348"></a>00348                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;wsdl error: &#39;</span>.$errstr);
<a name="l00349"></a>00349                 } elseif ($this-&gt;operations = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getOperations($this-&gt;portName, <span class="stringliteral">&#39;soap&#39;</span>)) {
<a name="l00350"></a>00350                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00351"></a>00351                         $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00352"></a>00352                         $this-&gt;bindingType = <span class="stringliteral">&#39;soap&#39;</span>;
<a name="l00353"></a>00353                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;got &#39;</span>.count($this-&gt;operations).<span class="stringliteral">&#39; operations from wsdl &#39;</span>.$this-&gt;wsdlFile.<span class="stringliteral">&#39; for binding type &#39;</span>.$this-&gt;bindingType);
<a name="l00354"></a>00354                 } elseif ($this-&gt;operations = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getOperations($this-&gt;portName, <span class="stringliteral">&#39;soap12&#39;</span>)) {
<a name="l00355"></a>00355                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00356"></a>00356                         $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00357"></a>00357                         $this-&gt;bindingType = <span class="stringliteral">&#39;soap12&#39;</span>;
<a name="l00358"></a>00358                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;got &#39;</span>.count($this-&gt;operations).<span class="stringliteral">&#39; operations from wsdl &#39;</span>.$this-&gt;wsdlFile.<span class="stringliteral">&#39; for binding type &#39;</span>.$this-&gt;bindingType);
<a name="l00359"></a>00359                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;**************** WARNING: SOAP 1.2 BINDING *****************&#39;</span>);
<a name="l00360"></a>00360                 } <span class="keywordflow">else</span> {
<a name="l00361"></a>00361                         $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;getDebug());
<a name="l00362"></a>00362                         $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;clearDebug();
<a name="l00363"></a>00363                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;getOperations returned false&#39;</span>);
<a name="l00364"></a>00364                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;no operations defined in the WSDL document!&#39;</span>);
<a name="l00365"></a>00365                 }
<a name="l00366"></a>00366         }
<a name="l00367"></a>00367 
<a name="l00373"></a><a class="code" href="classnusoap__client.html#aa71b9cdc567fc894b85891235f0028c5">00373</a>         function <a class="code" href="classnusoap__client.html#aa71b9cdc567fc894b85891235f0028c5">loadWSDL</a>() {
<a name="l00374"></a>00374                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;instantiating wsdl class with doc: &#39;</span>.$this-&gt;wsdlFile);
<a name="l00375"></a>00375                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a> = <span class="keyword">new</span> <a class="code" href="classwsdl.html">wsdl</a>(<span class="stringliteral">&#39;&#39;</span>,$this-&gt;proxyhost,$this-&gt;proxyport,$this-&gt;proxyusername,$this-&gt;proxypassword,$this-&gt;timeout,$this-&gt;response_timeout,$this-&gt;curl_options,$this-&gt;use_curl);
<a name="l00376"></a>00376                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;setCredentials($this-&gt;username, $this-&gt;password, $this-&gt;authtype, $this-&gt;certRequest);
<a name="l00377"></a>00377                 $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>-&gt;fetchWSDL($this-&gt;wsdlFile);
<a name="l00378"></a>00378                 $this-&gt;<a class="code" href="classnusoap__client.html#a9df6a7844a1a356eba2d3486c7afb429">checkWSDL</a>();
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380 
<a name="l00388"></a><a class="code" href="classnusoap__client.html#a8596422939874a9ed4bc5d1715807869">00388</a>         function <a class="code" href="classnusoap__client.html#a8596422939874a9ed4bc5d1715807869">getOperationData</a>($operation){
<a name="l00389"></a>00389                 <span class="keywordflow">if</span> ($this-&gt;endpointType == <span class="stringliteral">&#39;wsdl&#39;</span> &amp;&amp; is_null($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>)) {
<a name="l00390"></a>00390                         $this-&gt;<a class="code" href="classnusoap__client.html#aa71b9cdc567fc894b85891235f0028c5">loadWSDL</a>();
<a name="l00391"></a>00391                         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>())
<a name="l00392"></a>00392                                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00393"></a>00393                 }
<a name="l00394"></a>00394                 <span class="keywordflow">if</span>(isset($this-&gt;operations[$operation])){
<a name="l00395"></a>00395                         <span class="keywordflow">return</span> $this-&gt;operations[$operation];
<a name="l00396"></a>00396                 }
<a name="l00397"></a>00397                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;No data for operation: $operation&quot;</span>);
<a name="l00398"></a>00398         }
<a name="l00399"></a>00399 
<a name="l00414"></a><a class="code" href="classnusoap__client.html#a1a9ee5485589e291619da192324f70bc">00414</a>         function <a class="code" href="classnusoap__client.html#a1a9ee5485589e291619da192324f70bc">send</a>($msg, $soapaction = <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classnusoap__client.html#aba5ca2d7e6c45a4773cddec256c9a192">$timeout</a>=0, <a class="code" href="classnusoap__client.html#a41b0366193fea3a46ac06dd3d794429f">$response_timeout</a>=30) {
<a name="l00415"></a>00415                 $this-&gt;<a class="code" href="classnusoap__client.html#a4817f0dfd72202fcee4527e398919ae1">checkCookies</a>();
<a name="l00416"></a>00416                 <span class="comment">// detect transport</span>
<a name="l00417"></a>00417                 <span class="keywordflow">switch</span>(<span class="keyword">true</span>){
<a name="l00418"></a>00418                         <span class="comment">// http(s)</span>
<a name="l00419"></a>00419                         <span class="keywordflow">case</span> preg_match(<span class="stringliteral">&#39;/^http/&#39;</span>,$this-&gt;endpoint):
<a name="l00420"></a>00420                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;transporting via HTTP&#39;</span>);
<a name="l00421"></a>00421                                 <span class="keywordflow">if</span>($this-&gt;persistentConnection == <span class="keyword">true</span> &amp;&amp; is_object($this-&gt;persistentConnection)){
<a name="l00422"></a>00422                                         $http =&amp; $this-&gt;persistentConnection;
<a name="l00423"></a>00423                                 } <span class="keywordflow">else</span> {
<a name="l00424"></a>00424                                         $http = <span class="keyword">new</span> <a class="code" href="classsoap__transport__http.html">soap_transport_http</a>($this-&gt;endpoint, $this-&gt;curl_options, $this-&gt;use_curl);
<a name="l00425"></a>00425                                         <span class="keywordflow">if</span> ($this-&gt;persistentConnection) {
<a name="l00426"></a>00426                                                 $http-&gt;usePersistentConnection();
<a name="l00427"></a>00427                                         }
<a name="l00428"></a>00428                                 }
<a name="l00429"></a>00429                                 $http-&gt;setContentType($this-&gt;<a class="code" href="classnusoap__client.html#a6698e90874e2e7f14f29eeefe0216e0e">getHTTPContentType</a>(), $this-&gt;<a class="code" href="classnusoap__client.html#a80414bfbaf2d76036be7681b31db890a">getHTTPContentTypeCharset</a>());
<a name="l00430"></a>00430                                 $http-&gt;setSOAPAction($soapaction);
<a name="l00431"></a>00431                                 <span class="keywordflow">if</span>($this-&gt;proxyhost &amp;&amp; $this-&gt;proxyport){
<a name="l00432"></a>00432                                         $http-&gt;setProxy($this-&gt;proxyhost,$this-&gt;proxyport,$this-&gt;proxyusername,$this-&gt;proxypassword);
<a name="l00433"></a>00433                                 }
<a name="l00434"></a>00434                 <span class="keywordflow">if</span>($this-&gt;authtype != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00435"></a>00435                                         $http-&gt;setCredentials($this-&gt;username, $this-&gt;password, $this-&gt;authtype, array(), $this-&gt;certRequest);
<a name="l00436"></a>00436                                 }
<a name="l00437"></a>00437                                 <span class="keywordflow">if</span>($this-&gt;http_encoding != <span class="stringliteral">&#39;&#39;</span>){
<a name="l00438"></a>00438                                         $http-&gt;setEncoding($this-&gt;http_encoding);
<a name="l00439"></a>00439                                 }
<a name="l00440"></a>00440                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;sending message, length=&#39;</span>.strlen($msg));
<a name="l00441"></a>00441                                 <span class="keywordflow">if</span>(preg_match(<span class="stringliteral">&#39;/^http:/&#39;</span>,$this-&gt;endpoint)){
<a name="l00442"></a>00442                                 <span class="comment">//if(strpos($this-&gt;endpoint,&#39;http:&#39;)){</span>
<a name="l00443"></a>00443                                         $this-&gt;responseData = $http-&gt;send($msg,<a class="code" href="classnusoap__client.html#aba5ca2d7e6c45a4773cddec256c9a192">$timeout</a>,<a class="code" href="classnusoap__client.html#a41b0366193fea3a46ac06dd3d794429f">$response_timeout</a>,$this-&gt;cookies);
<a name="l00444"></a>00444                                 } elseif(preg_match(<span class="stringliteral">&#39;/^https/&#39;</span>,$this-&gt;endpoint)){
<a name="l00445"></a>00445                                 <span class="comment">//} elseif(strpos($this-&gt;endpoint,&#39;https:&#39;)){</span>
<a name="l00446"></a>00446                                         <span class="comment">//if(phpversion() == &#39;4.3.0-dev&#39;){</span>
<a name="l00447"></a>00447                                                 <span class="comment">//$response = $http-&gt;send($msg,$timeout,$response_timeout);</span>
<a name="l00448"></a>00448                                 <span class="comment">//$this-&gt;request = $http-&gt;outgoing_payload;</span>
<a name="l00449"></a>00449                                                 <span class="comment">//$this-&gt;response = $http-&gt;incoming_payload;</span>
<a name="l00450"></a>00450                                         <span class="comment">//} else</span>
<a name="l00451"></a>00451                                         $this-&gt;responseData = $http-&gt;sendHTTPS($msg,<a class="code" href="classnusoap__client.html#aba5ca2d7e6c45a4773cddec256c9a192">$timeout</a>,<a class="code" href="classnusoap__client.html#a41b0366193fea3a46ac06dd3d794429f">$response_timeout</a>,$this-&gt;cookies);
<a name="l00452"></a>00452                                 } <span class="keywordflow">else</span> {
<a name="l00453"></a>00453                                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;no http/s in endpoint url&#39;</span>);
<a name="l00454"></a>00454                                 }
<a name="l00455"></a>00455                                 $this-&gt;request = $http-&gt;outgoing_payload;
<a name="l00456"></a>00456                                 $this-&gt;response = $http-&gt;incoming_payload;
<a name="l00457"></a>00457                                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($http-&gt;getDebug());
<a name="l00458"></a>00458                                 $this-&gt;<a class="code" href="classnusoap__client.html#ad0fbe30e4c04c3803fd1abb894a29d8a">UpdateCookies</a>($http-&gt;incoming_cookies);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460                                 <span class="comment">// save transport object if using persistent connections</span>
<a name="l00461"></a>00461                                 <span class="keywordflow">if</span> ($this-&gt;persistentConnection) {
<a name="l00462"></a>00462                                         $http-&gt;clearDebug();
<a name="l00463"></a>00463                                         <span class="keywordflow">if</span> (!is_object($this-&gt;persistentConnection)) {
<a name="l00464"></a>00464                                                 $this-&gt;persistentConnection = $http;
<a name="l00465"></a>00465                                         }
<a name="l00466"></a>00466                                 }
<a name="l00467"></a>00467                                 
<a name="l00468"></a>00468                                 <span class="keywordflow">if</span>(<a class="code" href="client_8php.html#acfc00bd4a41804552c630950bf61a51f">$err</a> = $http-&gt;getError()){
<a name="l00469"></a>00469                                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;HTTP Error: &#39;</span>.<a class="code" href="client_8php.html#acfc00bd4a41804552c630950bf61a51f">$err</a>);
<a name="l00470"></a>00470                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00471"></a>00471                                 } elseif($this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>()){
<a name="l00472"></a>00472                                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00473"></a>00473                                 } <span class="keywordflow">else</span> {
<a name="l00474"></a>00474                                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;got response, length=&#39;</span>. strlen($this-&gt;responseData).<span class="stringliteral">&#39; type=&#39;</span>.$http-&gt;incoming_headers[<span class="stringliteral">&#39;content-type&#39;</span>]);
<a name="l00475"></a>00475                                         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classnusoap__client.html#af8a932742c466b9f2e53ff56ddd64608">parseResponse</a>($http-&gt;incoming_headers, $this-&gt;responseData);
<a name="l00476"></a>00476                                 }
<a name="l00477"></a>00477                         <span class="keywordflow">break</span>;
<a name="l00478"></a>00478                         <span class="keywordflow">default</span>:
<a name="l00479"></a>00479                                 $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;no transport found, or selected transport is not yet supported!&#39;</span>);
<a name="l00480"></a>00480                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00481"></a>00481                         <span class="keywordflow">break</span>;
<a name="l00482"></a>00482                 }
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484 
<a name="l00493"></a><a class="code" href="classnusoap__client.html#af8a932742c466b9f2e53ff56ddd64608">00493</a>     function <a class="code" href="classnusoap__client.html#af8a932742c466b9f2e53ff56ddd64608">parseResponse</a>($headers, $data) {
<a name="l00494"></a>00494                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Entering parseResponse() for data of length &#39;</span> . strlen($data) . <span class="stringliteral">&#39; headers:&#39;</span>);
<a name="l00495"></a>00495                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($headers));
<a name="l00496"></a>00496         <span class="keywordflow">if</span> (!isset($headers[<span class="stringliteral">&#39;content-type&#39;</span>])) {
<a name="l00497"></a>00497                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;Response not of type text/xml (no content-type header)&#39;</span>);
<a name="l00498"></a>00498                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500                 <span class="keywordflow">if</span> (!strstr($headers[<span class="stringliteral">&#39;content-type&#39;</span>], <span class="stringliteral">&#39;text/xml&#39;</span>)) {
<a name="l00501"></a>00501                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>(<span class="stringliteral">&#39;Response not of type text/xml: &#39;</span> . $headers[<span class="stringliteral">&#39;content-type&#39;</span>]);
<a name="l00502"></a>00502                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00503"></a>00503                 }
<a name="l00504"></a>00504                 <span class="keywordflow">if</span> (strpos($headers[<span class="stringliteral">&#39;content-type&#39;</span>], <span class="charliteral">&#39;=&#39;</span>)) {
<a name="l00505"></a>00505                         $enc = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, substr(strstr($headers[<span class="stringliteral">&quot;content-type&quot;</span>], <span class="charliteral">&#39;=&#39;</span>), 1));
<a name="l00506"></a>00506                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Got response encoding: &#39;</span> . $enc);
<a name="l00507"></a>00507                         <span class="keywordflow">if</span>(preg_match(<span class="stringliteral">&#39;/^(ISO-8859-1|US-ASCII|UTF-8)$/i&#39;</span>,$enc)){
<a name="l00508"></a>00508                                 $this-&gt;xml_encoding = strtoupper($enc);
<a name="l00509"></a>00509                         } <span class="keywordflow">else</span> {
<a name="l00510"></a>00510                                 $this-&gt;xml_encoding = <span class="stringliteral">&#39;US-ASCII&#39;</span>;
<a name="l00511"></a>00511                         }
<a name="l00512"></a>00512                 } <span class="keywordflow">else</span> {
<a name="l00513"></a>00513                         <span class="comment">// should be US-ASCII for HTTP 1.0 or ISO-8859-1 for HTTP 1.1</span>
<a name="l00514"></a>00514                         $this-&gt;xml_encoding = <span class="stringliteral">&#39;ISO-8859-1&#39;</span>;
<a name="l00515"></a>00515                 }
<a name="l00516"></a>00516                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Use encoding: &#39;</span> . $this-&gt;xml_encoding . <span class="stringliteral">&#39; when creating nusoap_parser&#39;</span>);
<a name="l00517"></a>00517                 $parser = <span class="keyword">new</span> <a class="code" href="classnusoap__parser.html">nusoap_parser</a>($data,$this-&gt;xml_encoding,$this-&gt;operation,$this-&gt;decode_utf8);
<a name="l00518"></a>00518                 <span class="comment">// add parser debug data to our debug</span>
<a name="l00519"></a>00519                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($parser-&gt;getDebug());
<a name="l00520"></a>00520                 <span class="comment">// if parse errors</span>
<a name="l00521"></a>00521                 <span class="keywordflow">if</span>($errstr = $parser-&gt;getError()){
<a name="l00522"></a>00522                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>( $errstr);
<a name="l00523"></a>00523                         <span class="comment">// destroy the parser object</span>
<a name="l00524"></a>00524                         unset($parser);
<a name="l00525"></a>00525                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00526"></a>00526                 } <span class="keywordflow">else</span> {
<a name="l00527"></a>00527                         <span class="comment">// get SOAP headers</span>
<a name="l00528"></a>00528                         $this-&gt;responseHeaders = $parser-&gt;getHeaders();
<a name="l00529"></a>00529                         <span class="comment">// get SOAP headers</span>
<a name="l00530"></a>00530                         $this-&gt;responseHeader = $parser-&gt;get_soapheader();
<a name="l00531"></a>00531                         <span class="comment">// get decoded message</span>
<a name="l00532"></a>00532                         $return = $parser-&gt;get_soapbody();
<a name="l00533"></a>00533             <span class="comment">// add document for doclit support</span>
<a name="l00534"></a>00534             $this-&gt;document = $parser-&gt;document;
<a name="l00535"></a>00535                         <span class="comment">// destroy the parser object</span>
<a name="l00536"></a>00536                         unset($parser);
<a name="l00537"></a>00537                         <span class="comment">// return decode message</span>
<a name="l00538"></a>00538                         <span class="keywordflow">return</span> $return;
<a name="l00539"></a>00539                 }
<a name="l00540"></a>00540          }
<a name="l00541"></a>00541 
<a name="l00549"></a><a class="code" href="classnusoap__client.html#a043a65055dbe46a8fff19fe100a1bb10">00549</a>         function <a class="code" href="classnusoap__client.html#a043a65055dbe46a8fff19fe100a1bb10">setCurlOption</a>($option, $value) {
<a name="l00550"></a>00550                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;setCurlOption option=$option, value=&quot;</span>);
<a name="l00551"></a>00551                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($value));
<a name="l00552"></a>00552                 $this-&gt;curl_options[$option] = $value;
<a name="l00553"></a>00553         }
<a name="l00554"></a>00554 
<a name="l00561"></a><a class="code" href="classnusoap__client.html#ad0007907a3dbae33082c976a4f5f17ab">00561</a>         function <a class="code" href="classnusoap__client.html#ad0007907a3dbae33082c976a4f5f17ab">setEndpoint</a>(<a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>) {
<a name="l00562"></a>00562                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;setEndpoint(\&quot;$endpoint\&quot;)&quot;</span>);
<a name="l00563"></a>00563                 $this-&gt;forceEndpoint = <a class="code" href="classnusoap__client.html#abc466379a93a1d6e6a612d901863c3b5">$endpoint</a>;
<a name="l00564"></a>00564         }
<a name="l00565"></a>00565 
<a name="l00572"></a><a class="code" href="classnusoap__client.html#aa2b4f40aae98c76c53ab60d4d8759d09">00572</a>         function <a class="code" href="classnusoap__client.html#aa2b4f40aae98c76c53ab60d4d8759d09">setHeaders</a>($headers){
<a name="l00573"></a>00573                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;setHeaders headers=&quot;</span>);
<a name="l00574"></a>00574                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($headers));
<a name="l00575"></a>00575                 $this-&gt;requestHeaders = $headers;
<a name="l00576"></a>00576         }
<a name="l00577"></a>00577 
<a name="l00584"></a><a class="code" href="classnusoap__client.html#ad8a47892c2094f54c1e3508e5a4b3100">00584</a>         function <a class="code" href="classnusoap__client.html#ad8a47892c2094f54c1e3508e5a4b3100">getHeaders</a>(){
<a name="l00585"></a>00585                 <span class="keywordflow">return</span> $this-&gt;responseHeaders;
<a name="l00586"></a>00586         }
<a name="l00587"></a>00587 
<a name="l00594"></a><a class="code" href="classnusoap__client.html#a6eefe0d355d0b99e2f0edd5d6e9370d5">00594</a>         function <a class="code" href="classnusoap__client.html#a6eefe0d355d0b99e2f0edd5d6e9370d5">getHeader</a>(){
<a name="l00595"></a>00595                 <span class="keywordflow">return</span> $this-&gt;responseHeader;
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597 
<a name="l00607"></a><a class="code" href="classnusoap__client.html#a5ebe55a79be3122d427f6621c74f97aa">00607</a>         function <a class="code" href="classnusoap__client.html#a5ebe55a79be3122d427f6621c74f97aa">setHTTPProxy</a>(<a class="code" href="classnusoap__client.html#aa338793644c3c11e9f26b037183edcb4">$proxyhost</a>, <a class="code" href="classnusoap__client.html#a0ec7742ef4e60957bb2434e4ae1687b9">$proxyport</a>, <a class="code" href="classnusoap__client.html#a7cd6d5a82fb6497a40aab27e1912cfea">$proxyusername</a> = <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classnusoap__client.html#abba1ff96c63993ea3e2cc3ce50679d30">$proxypassword</a> = <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00608"></a>00608                 $this-&gt;proxyhost = <a class="code" href="classnusoap__client.html#aa338793644c3c11e9f26b037183edcb4">$proxyhost</a>;
<a name="l00609"></a>00609                 $this-&gt;proxyport = <a class="code" href="classnusoap__client.html#a0ec7742ef4e60957bb2434e4ae1687b9">$proxyport</a>;
<a name="l00610"></a>00610                 $this-&gt;proxyusername = <a class="code" href="classnusoap__client.html#a7cd6d5a82fb6497a40aab27e1912cfea">$proxyusername</a>;
<a name="l00611"></a>00611                 $this-&gt;proxypassword = <a class="code" href="classnusoap__client.html#abba1ff96c63993ea3e2cc3ce50679d30">$proxypassword</a>;
<a name="l00612"></a>00612         }
<a name="l00613"></a>00613 
<a name="l00623"></a><a class="code" href="classnusoap__client.html#a9d6f466251630b7efe89768352275876">00623</a>         function <a class="code" href="classnusoap__client.html#a9d6f466251630b7efe89768352275876">setCredentials</a>(<a class="code" href="classnusoap__client.html#a5a6e502b71a3d980d0d5b4f78a3836b2">$username</a>, <a class="code" href="classnusoap__client.html#a28db01da63367bdca6f6be2518c12548">$password</a>, <a class="code" href="classnusoap__client.html#a53330860c9fb44f860900eea3db67770">$authtype</a> = <span class="stringliteral">&#39;basic&#39;</span>, <a class="code" href="classnusoap__client.html#af9f9e6aca1a464fae03b4bcfe6be85d1">$certRequest</a> = array()) {
<a name="l00624"></a>00624                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;setCredentials username=$username authtype=$authtype certRequest=&quot;</span>);
<a name="l00625"></a>00625                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>($this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>(<a class="code" href="classnusoap__client.html#af9f9e6aca1a464fae03b4bcfe6be85d1">$certRequest</a>));
<a name="l00626"></a>00626                 $this-&gt;username = <a class="code" href="classnusoap__client.html#a5a6e502b71a3d980d0d5b4f78a3836b2">$username</a>;
<a name="l00627"></a>00627                 $this-&gt;password = <a class="code" href="classnusoap__client.html#a28db01da63367bdca6f6be2518c12548">$password</a>;
<a name="l00628"></a>00628                 $this-&gt;authtype = <a class="code" href="classnusoap__client.html#a53330860c9fb44f860900eea3db67770">$authtype</a>;
<a name="l00629"></a>00629                 $this-&gt;certRequest = <a class="code" href="classnusoap__client.html#af9f9e6aca1a464fae03b4bcfe6be85d1">$certRequest</a>;
<a name="l00630"></a>00630         }
<a name="l00631"></a>00631         
<a name="l00638"></a><a class="code" href="classnusoap__client.html#a695cd916a7d06fd60588d7dcc0bfd557">00638</a>         function <a class="code" href="classnusoap__client.html#a695cd916a7d06fd60588d7dcc0bfd557">setHTTPEncoding</a>($enc=<span class="stringliteral">&#39;gzip, deflate&#39;</span>){
<a name="l00639"></a>00639                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;setHTTPEncoding(\&quot;$enc\&quot;)&quot;</span>);
<a name="l00640"></a>00640                 $this-&gt;http_encoding = $enc;
<a name="l00641"></a>00641         }
<a name="l00642"></a>00642         
<a name="l00649"></a><a class="code" href="classnusoap__client.html#a3bf6b7946af9797836d91c6b85763856">00649</a>         function <a class="code" href="classnusoap__client.html#a3bf6b7946af9797836d91c6b85763856">setUseCURL</a>($use) {
<a name="l00650"></a>00650                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;setUseCURL($use)&quot;</span>);
<a name="l00651"></a>00651                 $this-&gt;use_curl = $use;
<a name="l00652"></a>00652         }
<a name="l00653"></a>00653 
<a name="l00659"></a><a class="code" href="classnusoap__client.html#a7a5ab2a0e6332054d1e74206cb252be1">00659</a>         function <a class="code" href="classnusoap__client.html#a7a5ab2a0e6332054d1e74206cb252be1">useHTTPPersistentConnection</a>(){
<a name="l00660"></a>00660                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;useHTTPPersistentConnection&quot;</span>);
<a name="l00661"></a>00661                 $this-&gt;persistentConnection = <span class="keyword">true</span>;
<a name="l00662"></a>00662         }
<a name="l00663"></a>00663         
<a name="l00675"></a><a class="code" href="classnusoap__client.html#a8f9b4ffb43d6d072cb52291d67389267">00675</a>         function <a class="code" href="classnusoap__client.html#a8f9b4ffb43d6d072cb52291d67389267">getDefaultRpcParams</a>() {
<a name="l00676"></a>00676                 <span class="keywordflow">return</span> $this-&gt;defaultRpcParams;
<a name="l00677"></a>00677         }
<a name="l00678"></a>00678 
<a name="l00690"></a><a class="code" href="classnusoap__client.html#acd44b4ae1f29ac0a4a77669535028a6e">00690</a>         function <a class="code" href="classnusoap__client.html#acd44b4ae1f29ac0a4a77669535028a6e">setDefaultRpcParams</a>($rpcParams) {
<a name="l00691"></a>00691                 $this-&gt;defaultRpcParams = $rpcParams;
<a name="l00692"></a>00692         }
<a name="l00693"></a>00693         
<a name="l00701"></a><a class="code" href="classnusoap__client.html#a23efadf7ba2999206ed94f8aee0458bc">00701</a>         function <a class="code" href="classnusoap__client.html#a23efadf7ba2999206ed94f8aee0458bc">getProxy</a>() {
<a name="l00702"></a>00702                 $r = rand();
<a name="l00703"></a>00703                 $evalStr = $this-&gt;<a class="code" href="classnusoap__client.html#ae3ef98298aab2e47d840a6640a502dc7">_getProxyClassCode</a>($r);
<a name="l00704"></a>00704                 <span class="comment">//$this-&gt;debug(&quot;proxy class: $evalStr&quot;);</span>
<a name="l00705"></a>00705                 <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>()) {
<a name="l00706"></a>00706                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;Error from _getProxyClassCode, so return NULL&quot;</span>);
<a name="l00707"></a>00707                         <span class="keywordflow">return</span> null;
<a name="l00708"></a>00708                 }
<a name="l00709"></a>00709                 <span class="comment">// eval the class</span>
<a name="l00710"></a>00710                 eval($evalStr);
<a name="l00711"></a>00711                 <span class="comment">// instantiate proxy object</span>
<a name="l00712"></a>00712                 eval(<span class="stringliteral">&quot;\$proxy = new nusoap_proxy_$r(&#39;&#39;);&quot;</span>);
<a name="l00713"></a>00713                 <span class="comment">// transfer current wsdl data to the proxy thereby avoiding parsing the wsdl twice</span>
<a name="l00714"></a>00714                 $proxy-&gt;endpointType = <span class="stringliteral">&#39;wsdl&#39;</span>;
<a name="l00715"></a>00715                 $proxy-&gt;wsdlFile = $this-&gt;wsdlFile;
<a name="l00716"></a>00716                 $proxy-&gt;wsdl = $this-&gt;<a class="code" href="classwsdl.html">wsdl</a>;
<a name="l00717"></a>00717                 $proxy-&gt;operations = $this-&gt;operations;
<a name="l00718"></a>00718                 $proxy-&gt;defaultRpcParams = $this-&gt;defaultRpcParams;
<a name="l00719"></a>00719                 <span class="comment">// transfer other state</span>
<a name="l00720"></a>00720                 $proxy-&gt;soap_defencoding = $this-&gt;soap_defencoding;
<a name="l00721"></a>00721                 $proxy-&gt;username = $this-&gt;username;
<a name="l00722"></a>00722                 $proxy-&gt;password = $this-&gt;password;
<a name="l00723"></a>00723                 $proxy-&gt;authtype = $this-&gt;authtype;
<a name="l00724"></a>00724                 $proxy-&gt;certRequest = $this-&gt;certRequest;
<a name="l00725"></a>00725                 $proxy-&gt;requestHeaders = $this-&gt;requestHeaders;
<a name="l00726"></a>00726                 $proxy-&gt;endpoint = $this-&gt;endpoint;
<a name="l00727"></a>00727                 $proxy-&gt;forceEndpoint = $this-&gt;forceEndpoint;
<a name="l00728"></a>00728                 $proxy-&gt;proxyhost = $this-&gt;proxyhost;
<a name="l00729"></a>00729                 $proxy-&gt;proxyport = $this-&gt;proxyport;
<a name="l00730"></a>00730                 $proxy-&gt;proxyusername = $this-&gt;proxyusername;
<a name="l00731"></a>00731                 $proxy-&gt;proxypassword = $this-&gt;proxypassword;
<a name="l00732"></a>00732                 $proxy-&gt;http_encoding = $this-&gt;http_encoding;
<a name="l00733"></a>00733                 $proxy-&gt;timeout = $this-&gt;timeout;
<a name="l00734"></a>00734                 $proxy-&gt;response_timeout = $this-&gt;response_timeout;
<a name="l00735"></a>00735                 $proxy-&gt;persistentConnection = &amp;$this-&gt;persistentConnection;
<a name="l00736"></a>00736                 $proxy-&gt;decode_utf8 = $this-&gt;decode_utf8;
<a name="l00737"></a>00737                 $proxy-&gt;curl_options = $this-&gt;curl_options;
<a name="l00738"></a>00738                 $proxy-&gt;bindingType = $this-&gt;bindingType;
<a name="l00739"></a>00739                 $proxy-&gt;use_curl = $this-&gt;use_curl;
<a name="l00740"></a>00740                 <span class="keywordflow">return</span> $proxy;
<a name="l00741"></a>00741         }
<a name="l00742"></a>00742 
<a name="l00749"></a><a class="code" href="classnusoap__client.html#ae3ef98298aab2e47d840a6640a502dc7">00749</a>         function <a class="code" href="classnusoap__client.html#ae3ef98298aab2e47d840a6640a502dc7">_getProxyClassCode</a>($r) {
<a name="l00750"></a>00750                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&quot;in getProxy endpointType=$this-&gt;endpointType&quot;</span>);
<a name="l00751"></a>00751                 $this-&gt;<a class="code" href="classnusoap__base.html#ac8304fa5d607d52124496ee242043f24">appendDebug</a>(<span class="stringliteral">&quot;wsdl=&quot;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#ab5511c6c0e6767b3e8b0ee9cad826641">varDump</a>($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>));
<a name="l00752"></a>00752                 <span class="keywordflow">if</span> ($this-&gt;endpointType != <span class="stringliteral">&#39;wsdl&#39;</span>) {
<a name="l00753"></a>00753                         $evalStr = <span class="stringliteral">&#39;A proxy can only be created for a WSDL client&#39;</span>;
<a name="l00754"></a>00754                         $this-&gt;<a class="code" href="classnusoap__base.html#a1be4ce561772039b0b84c423948f1f60">setError</a>($evalStr);
<a name="l00755"></a>00755                         $evalStr = <span class="stringliteral">&quot;echo \&quot;$evalStr\&quot;;&quot;</span>;
<a name="l00756"></a>00756                         <span class="keywordflow">return</span> $evalStr;
<a name="l00757"></a>00757                 }
<a name="l00758"></a>00758                 <span class="keywordflow">if</span> ($this-&gt;endpointType == <span class="stringliteral">&#39;wsdl&#39;</span> &amp;&amp; is_null($this-&gt;<a class="code" href="classwsdl.html">wsdl</a>)) {
<a name="l00759"></a>00759                         $this-&gt;<a class="code" href="classnusoap__client.html#aa71b9cdc567fc894b85891235f0028c5">loadWSDL</a>();
<a name="l00760"></a>00760                         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>()) {
<a name="l00761"></a>00761                                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;echo \&quot;&quot;</span> . $this-&gt;<a class="code" href="classnusoap__base.html#abf5c6d6bc06a33b7e201e24e2fb089eb">getError</a>() . <span class="stringliteral">&quot;\&quot;;&quot;</span>;
<a name="l00762"></a>00762                         }
<a name="l00763"></a>00763                 }
<a name="l00764"></a>00764                 $evalStr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00765"></a>00765                 <span class="keywordflow">foreach</span> ($this-&gt;operations as $operation =&gt; $opData) {
<a name="l00766"></a>00766                         <span class="keywordflow">if</span> ($operation != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00767"></a>00767                                 <span class="comment">// create param string and param comment string</span>
<a name="l00768"></a>00768                                 <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>($opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;parts&#39;</span>]) &gt; 0) {
<a name="l00769"></a>00769                                         $paramStr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00770"></a>00770                                         $paramArrayStr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00771"></a>00771                                         $paramCommentStr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00772"></a>00772                                         <span class="keywordflow">foreach</span> ($opData[<span class="stringliteral">&#39;input&#39;</span>][<span class="stringliteral">&#39;parts&#39;</span>] as $name =&gt; $type) {
<a name="l00773"></a>00773                                                 $paramStr .= <span class="stringliteral">&quot;\$$name, &quot;</span>;
<a name="l00774"></a>00774                                                 $paramArrayStr .= <span class="stringliteral">&quot;&#39;$name&#39; =&gt; \$$name, &quot;</span>;
<a name="l00775"></a>00775                                                 $paramCommentStr .= <span class="stringliteral">&quot;$type \$$name, &quot;</span>;
<a name="l00776"></a>00776                                         }
<a name="l00777"></a>00777                                         $paramStr = substr($paramStr, 0, strlen($paramStr)-2);
<a name="l00778"></a>00778                                         $paramArrayStr = substr($paramArrayStr, 0, strlen($paramArrayStr)-2);
<a name="l00779"></a>00779                                         $paramCommentStr = substr($paramCommentStr, 0, strlen($paramCommentStr)-2);
<a name="l00780"></a>00780                                 } <span class="keywordflow">else</span> {
<a name="l00781"></a>00781                                         $paramStr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00782"></a>00782                                         $paramArrayStr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00783"></a>00783                                         $paramCommentStr = <span class="stringliteral">&#39;void&#39;</span>;
<a name="l00784"></a>00784                                 }
<a name="l00785"></a>00785                                 $opData[<span class="stringliteral">&#39;namespace&#39;</span>] = !isset($opData[<span class="stringliteral">&#39;namespace&#39;</span>]) ? <span class="stringliteral">&#39;http://testuri.com&#39;</span> : $opData[<span class="stringliteral">&#39;namespace&#39;</span>];
<a name="l00786"></a>00786                                 $evalStr .= <span class="stringliteral">&quot;// $paramCommentStr</span>
<a name="l00787"></a>00787 <span class="stringliteral">        function &quot;</span> . str_replace(<span class="charliteral">&#39;.&#39;</span>, <span class="stringliteral">&#39;__&#39;</span>, $operation) . <span class="stringliteral">&quot;($paramStr) {</span>
<a name="l00788"></a>00788 <span class="stringliteral">                \$params = array($paramArrayStr);</span>
<a name="l00789"></a>00789 <span class="stringliteral">                return \$this-&gt;call(&#39;$operation&#39;, \$params, &#39;&quot;</span>.$opData[<span class="stringliteral">&#39;namespace&#39;</span>].<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.(isset($opData[<span class="stringliteral">&#39;soapAction&#39;</span>]) ? $opData[<span class="stringliteral">&#39;soapAction&#39;</span>] : <span class="stringliteral">&#39;&#39;</span>).<span class="stringliteral">&quot;&#39;);</span>
<a name="l00790"></a>00790 <span class="stringliteral">        }</span>
<a name="l00791"></a>00791 <span class="stringliteral">        &quot;</span>;
<a name="l00792"></a>00792                                 unset($paramStr);
<a name="l00793"></a>00793                                 unset($paramCommentStr);
<a name="l00794"></a>00794                         }
<a name="l00795"></a>00795                 }
<a name="l00796"></a>00796                 $evalStr = <span class="stringliteral">&#39;class nusoap_proxy_&#39;</span>.$r.<span class="stringliteral">&#39; extends nusoap_client {</span>
<a name="l00797"></a>00797 <span class="stringliteral">        &#39;</span>.$evalStr.<span class="stringliteral">&#39;</span>
<a name="l00798"></a>00798 <span class="stringliteral">}&#39;</span>;
<a name="l00799"></a>00799                 <span class="keywordflow">return</span> $evalStr;
<a name="l00800"></a>00800         }
<a name="l00801"></a>00801 
<a name="l00808"></a><a class="code" href="classnusoap__client.html#a478ed950c0b8dba6f9f5fcde3ff0d362">00808</a>         function <a class="code" href="classnusoap__client.html#a478ed950c0b8dba6f9f5fcde3ff0d362">getProxyClassCode</a>() {
<a name="l00809"></a>00809                 $r = rand();
<a name="l00810"></a>00810                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classnusoap__client.html#ae3ef98298aab2e47d840a6640a502dc7">_getProxyClassCode</a>($r);
<a name="l00811"></a>00811         }
<a name="l00812"></a>00812 
<a name="l00820"></a><a class="code" href="classnusoap__client.html#aa7d92aba4e7fd910b55f68b43e72eda9">00820</a>         function <a class="code" href="classnusoap__client.html#aa7d92aba4e7fd910b55f68b43e72eda9">getHTTPBody</a>($soapmsg) {
<a name="l00821"></a>00821                 <span class="keywordflow">return</span> $soapmsg;
<a name="l00822"></a>00822         }
<a name="l00823"></a>00823         
<a name="l00832"></a><a class="code" href="classnusoap__client.html#a6698e90874e2e7f14f29eeefe0216e0e">00832</a>         function <a class="code" href="classnusoap__client.html#a6698e90874e2e7f14f29eeefe0216e0e">getHTTPContentType</a>() {
<a name="l00833"></a>00833                 <span class="keywordflow">return</span> <span class="stringliteral">&#39;text/xml&#39;</span>;
<a name="l00834"></a>00834         }
<a name="l00835"></a>00835         
<a name="l00845"></a><a class="code" href="classnusoap__client.html#a80414bfbaf2d76036be7681b31db890a">00845</a>         function <a class="code" href="classnusoap__client.html#a80414bfbaf2d76036be7681b31db890a">getHTTPContentTypeCharset</a>() {
<a name="l00846"></a>00846                 <span class="keywordflow">return</span> $this-&gt;soap_defencoding;
<a name="l00847"></a>00847         }
<a name="l00848"></a>00848 
<a name="l00849"></a>00849         <span class="comment">/*</span>
<a name="l00850"></a>00850 <span class="comment">        * whether or not parser should decode utf8 element content</span>
<a name="l00851"></a>00851 <span class="comment">    *</span>
<a name="l00852"></a>00852 <span class="comment">    * @return   always returns true</span>
<a name="l00853"></a>00853 <span class="comment">    * @access   public</span>
<a name="l00854"></a>00854 <span class="comment">    */</span>
<a name="l00855"></a><a class="code" href="classnusoap__client.html#a71d85331b5730e2860ddb4fe364ba2c0">00855</a>     function <a class="code" href="classnusoap__client.html#a71d85331b5730e2860ddb4fe364ba2c0">decodeUTF8</a>($bool){
<a name="l00856"></a>00856                 $this-&gt;decode_utf8 = $bool;
<a name="l00857"></a>00857                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00858"></a>00858     }
<a name="l00859"></a>00859 
<a name="l00868"></a><a class="code" href="classnusoap__client.html#a7c985069b20c8e945c7358f07a289c83">00868</a>         function <a class="code" href="classnusoap__client.html#a7c985069b20c8e945c7358f07a289c83">setCookie</a>($name, $value) {
<a name="l00869"></a>00869                 <span class="keywordflow">if</span> (strlen($name) == 0) {
<a name="l00870"></a>00870                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00871"></a>00871                 }
<a name="l00872"></a>00872                 $this-&gt;cookies[] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;value&#39;</span> =&gt; $value);
<a name="l00873"></a>00873                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00874"></a>00874         }
<a name="l00875"></a>00875 
<a name="l00882"></a><a class="code" href="classnusoap__client.html#aed3add6ccef87db1fa8f1dfa98edf8e8">00882</a>         function <a class="code" href="classnusoap__client.html#aed3add6ccef87db1fa8f1dfa98edf8e8">getCookies</a>() {
<a name="l00883"></a>00883                 <span class="keywordflow">return</span> $this-&gt;cookies;
<a name="l00884"></a>00884         }
<a name="l00885"></a>00885 
<a name="l00892"></a><a class="code" href="classnusoap__client.html#a4817f0dfd72202fcee4527e398919ae1">00892</a>         function <a class="code" href="classnusoap__client.html#a4817f0dfd72202fcee4527e398919ae1">checkCookies</a>() {
<a name="l00893"></a>00893                 <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>($this-&gt;cookies) == 0) {
<a name="l00894"></a>00894                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00895"></a>00895                 }
<a name="l00896"></a>00896                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;checkCookie: check &#39;</span> . <span class="keyword">sizeof</span>($this-&gt;cookies) . <span class="stringliteral">&#39; cookies&#39;</span>);
<a name="l00897"></a>00897                 $curr_cookies = $this-&gt;cookies;
<a name="l00898"></a>00898                 $this-&gt;cookies = array();
<a name="l00899"></a>00899                 <span class="keywordflow">foreach</span> ($curr_cookies as $cookie) {
<a name="l00900"></a>00900                         <span class="keywordflow">if</span> (! is_array($cookie)) {
<a name="l00901"></a>00901                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Remove cookie that is not an array&#39;</span>);
<a name="l00902"></a>00902                                 <span class="keywordflow">continue</span>;
<a name="l00903"></a>00903                         }
<a name="l00904"></a>00904                         <span class="keywordflow">if</span> ((isset($cookie[<span class="stringliteral">&#39;expires&#39;</span>])) &amp;&amp; (! empty($cookie[<span class="stringliteral">&#39;expires&#39;</span>]))) {
<a name="l00905"></a>00905                                 <span class="keywordflow">if</span> (strtotime($cookie[<span class="stringliteral">&#39;expires&#39;</span>]) &gt; time()) {
<a name="l00906"></a>00906                                         $this-&gt;cookies[] = $cookie;
<a name="l00907"></a>00907                                 } <span class="keywordflow">else</span> {
<a name="l00908"></a>00908                                         $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Remove expired cookie &#39;</span> . $cookie[<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l00909"></a>00909                                 }
<a name="l00910"></a>00910                         } <span class="keywordflow">else</span> {
<a name="l00911"></a>00911                                 $this-&gt;cookies[] = $cookie;
<a name="l00912"></a>00912                         }
<a name="l00913"></a>00913                 }
<a name="l00914"></a>00914                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;checkCookie: &#39;</span>.<span class="keyword">sizeof</span>($this-&gt;cookies).<span class="stringliteral">&#39; cookies left in array&#39;</span>);
<a name="l00915"></a>00915                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00916"></a>00916         }
<a name="l00917"></a>00917 
<a name="l00925"></a><a class="code" href="classnusoap__client.html#ad0fbe30e4c04c3803fd1abb894a29d8a">00925</a>         function <a class="code" href="classnusoap__client.html#ad0fbe30e4c04c3803fd1abb894a29d8a">UpdateCookies</a>(<a class="code" href="classnusoap__client.html#a488524f98da3cb0b016d393d39f48720">$cookies</a>) {
<a name="l00926"></a>00926                 <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>($this-&gt;cookies) == 0) {
<a name="l00927"></a>00927                         <span class="comment">// no existing cookies: take whatever is new</span>
<a name="l00928"></a>00928                         <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="classnusoap__client.html#a488524f98da3cb0b016d393d39f48720">$cookies</a>) &gt; 0) {
<a name="l00929"></a>00929                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Setting new cookie(s)&#39;</span>);
<a name="l00930"></a>00930                                 $this-&gt;cookies = <a class="code" href="classnusoap__client.html#a488524f98da3cb0b016d393d39f48720">$cookies</a>;
<a name="l00931"></a>00931                         }
<a name="l00932"></a>00932                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00933"></a>00933                 }
<a name="l00934"></a>00934                 <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="classnusoap__client.html#a488524f98da3cb0b016d393d39f48720">$cookies</a>) == 0) {
<a name="l00935"></a>00935                         <span class="comment">// no new cookies: keep what we&#39;ve got</span>
<a name="l00936"></a>00936                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00937"></a>00937                 }
<a name="l00938"></a>00938                 <span class="comment">// merge</span>
<a name="l00939"></a>00939                 <span class="keywordflow">foreach</span> (<a class="code" href="classnusoap__client.html#a488524f98da3cb0b016d393d39f48720">$cookies</a> as $newCookie) {
<a name="l00940"></a>00940                         <span class="keywordflow">if</span> (!is_array($newCookie)) {
<a name="l00941"></a>00941                                 <span class="keywordflow">continue</span>;
<a name="l00942"></a>00942                         }
<a name="l00943"></a>00943                         <span class="keywordflow">if</span> ((!isset($newCookie[<span class="stringliteral">&#39;name&#39;</span>])) || (!isset($newCookie[<span class="stringliteral">&#39;value&#39;</span>]))) {
<a name="l00944"></a>00944                                 <span class="keywordflow">continue</span>;
<a name="l00945"></a>00945                         }
<a name="l00946"></a>00946                         $newName = $newCookie[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l00947"></a>00947 
<a name="l00948"></a>00948                         $found = <span class="keyword">false</span>;
<a name="l00949"></a>00949                         <span class="keywordflow">for</span> (<a class="code" href="ocrad_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> = 0; <a class="code" href="ocrad_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> &lt; count($this-&gt;cookies); <a class="code" href="ocrad_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>++) {
<a name="l00950"></a>00950                                 $cookie = $this-&gt;cookies[<a class="code" href="ocrad_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l00951"></a>00951                                 <span class="keywordflow">if</span> (!is_array($cookie)) {
<a name="l00952"></a>00952                                         <span class="keywordflow">continue</span>;
<a name="l00953"></a>00953                                 }
<a name="l00954"></a>00954                                 <span class="keywordflow">if</span> (!isset($cookie[<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l00955"></a>00955                                         <span class="keywordflow">continue</span>;
<a name="l00956"></a>00956                                 }
<a name="l00957"></a>00957                                 <span class="keywordflow">if</span> ($newName != $cookie[<span class="stringliteral">&#39;name&#39;</span>]) {
<a name="l00958"></a>00958                                         <span class="keywordflow">continue</span>;
<a name="l00959"></a>00959                                 }
<a name="l00960"></a>00960                                 $newDomain = isset($newCookie[<span class="stringliteral">&#39;domain&#39;</span>]) ? $newCookie[<span class="stringliteral">&#39;domain&#39;</span>] : <span class="stringliteral">&#39;NODOMAIN&#39;</span>;
<a name="l00961"></a>00961                                 $domain = isset($cookie[<span class="stringliteral">&#39;domain&#39;</span>]) ? $cookie[<span class="stringliteral">&#39;domain&#39;</span>] : <span class="stringliteral">&#39;NODOMAIN&#39;</span>;
<a name="l00962"></a>00962                                 <span class="keywordflow">if</span> ($newDomain != $domain) {
<a name="l00963"></a>00963                                         <span class="keywordflow">continue</span>;
<a name="l00964"></a>00964                                 }
<a name="l00965"></a>00965                                 $newPath = isset($newCookie[<span class="stringliteral">&#39;path&#39;</span>]) ? $newCookie[<span class="stringliteral">&#39;path&#39;</span>] : <span class="stringliteral">&#39;NOPATH&#39;</span>;
<a name="l00966"></a>00966                                 $path = isset($cookie[<span class="stringliteral">&#39;path&#39;</span>]) ? $cookie[<span class="stringliteral">&#39;path&#39;</span>] : <span class="stringliteral">&#39;NOPATH&#39;</span>;
<a name="l00967"></a>00967                                 <span class="keywordflow">if</span> ($newPath != $path) {
<a name="l00968"></a>00968                                         <span class="keywordflow">continue</span>;
<a name="l00969"></a>00969                                 }
<a name="l00970"></a>00970                                 $this-&gt;cookies[<a class="code" href="ocrad_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = $newCookie;
<a name="l00971"></a>00971                                 $found = <span class="keyword">true</span>;
<a name="l00972"></a>00972                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Update cookie &#39;</span> . $newName . <span class="charliteral">&#39;=&#39;</span> . $newCookie[<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l00973"></a>00973                                 <span class="keywordflow">break</span>;
<a name="l00974"></a>00974                         }
<a name="l00975"></a>00975                         <span class="keywordflow">if</span> (! $found) {
<a name="l00976"></a>00976                                 $this-&gt;<a class="code" href="classnusoap__base.html#a2ff2869a93609f3f282863a7273c26c1">debug</a>(<span class="stringliteral">&#39;Add cookie &#39;</span> . $newName . <span class="charliteral">&#39;=&#39;</span> . $newCookie[<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l00977"></a>00977                                 $this-&gt;cookies[] = $newCookie;
<a name="l00978"></a>00978                         }
<a name="l00979"></a>00979                 }
<a name="l00980"></a>00980                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00981"></a>00981         }
<a name="l00982"></a>00982 }
<a name="l00983"></a>00983 
<a name="l00984"></a>00984 <span class="keywordflow">if</span> (!extension_loaded(<span class="stringliteral">&#39;soap&#39;</span>)) {
<a name="l00988"></a>00988         <span class="keyword">class </span>soapclient <span class="keyword">extends</span> <a class="code" href="classnusoap__client.html">nusoap_client</a> {
<a name="l00989"></a>00989         }
<a name="l00990"></a>00990 }
<a name="l00991"></a>00991 ?&gt;
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Dec 9 09:36:43 2010 for DAEDrupalInterface by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
